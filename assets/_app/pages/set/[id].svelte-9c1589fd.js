import{S as t,i as e,s,e as n,c as a,b as l,f as o,I as r,J as i,d as c,P as d,j as u,m as h,o as f,x as g,u as m,v,a as p,E as x,k as $,O as y,n as I,w,H as k,K as C,A as E,z as P,Q as j,r as L,R as S}from"../../chunks/vendor-956ff56e.js";import{c as z,j as D,E as G,a as H}from"../../chunks/Store-36852678.js";function M(t){let e,s,u,h,f;return{c(){e=n("img"),this.h()},l(t){e=a(t,"IMG",{src:!0,alt:!0,loading:!0,class:!0}),this.h()},h(){e.src!==(s=t[0].images.small)&&l(e,"src",s),l(e,"alt",u=t[0].name+" card"),l(e,"loading","lazy"),l(e,"class","svelte-14avgyx")},m(t,s){o(t,e,s),f=!0},p(t,[n]){(!f||1&n&&e.src!==(s=t[0].images.small))&&l(e,"src",s),(!f||1&n&&u!==(u=t[0].name+" card"))&&l(e,"alt",u)},i(t){f||(r((()=>{h||(h=i(e,d,{},!0)),h.run(1)})),f=!0)},o(t){h||(h=i(e,d,{},!1)),h.run(0),f=!1},d(t){t&&c(e),t&&h&&h.end()}}}function T(t,e,s){let{card:n}=e;return n.set.id.toUpperCase(),n.set.id.toUpperCase(),n.number,t.$$set=t=>{"card"in t&&s(0,n=t.card)},[n]}class U extends t{constructor(t){super(),e(this,t,T,M,s,{card:0})}}const{document:V}=j;function b(t,e,s){const n=t.slice();return n[10]=e[s],n}function q(t){let e,s;return{c(){e=n("img"),this.h()},l(t){e=a(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){e.src!==(s=t[2].images.logo)&&l(e,"src",s),l(e,"alt","serie logo"),l(e,"class","header svelte-1xp7x0e")},m(t,s){o(t,e,s)},p(t,n){4&n&&e.src!==(s=t[2].images.logo)&&l(e,"src",s)},d(t){t&&c(e)}}}function _(t){let e,s;return e=new U({props:{card:t[10]}}),{c(){u(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,n){f(e,t,n),s=!0},p(t,s){const n={};8&s&&(n.card=t[10]),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){m(e.$$.fragment,t),s=!1},d(t){v(e,t)}}}function A(t){let e,s,r;return{c(){e=n("div"),s=n("img"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=p(e);s=a(n,"IMG",{src:!0,alt:!0}),n.forEach(c),this.h()},h(){s.src!==(r="/img/loading.svg")&&l(s,"src","/img/loading.svg"),l(s,"alt","loading"),l(e,"class","load svelte-1xp7x0e")},m(t,n){o(t,e,n),x(e,s)},d(t){t&&c(e)}}}function B(t){var e,s,r;let i,d,u,h,f,v,C;V.title=i="Pokemon Cards - "+(null==(e=t[2])?void 0:e.series);let E=(null==(r=null==(s=t[2])?void 0:s.images)?void 0:r.logo)&&q(t),P=t[3],j=[];for(let n=0;n<P.length;n+=1)j[n]=_(b(t,P,n));const S=t=>m(j[t],1,1,(()=>{j[t]=null}));let z=t[3].length<t[1]&&A();return{c(){d=$(),u=n("div"),E&&E.c(),h=$(),f=n("div");for(let t=0;t<j.length;t+=1)j[t].c();v=$(),z&&z.c(),this.h()},l(t){y('[data-svelte="svelte-4gk4uf"]',V.head).forEach(c),d=I(t),u=a(t,"DIV",{class:!0});var e=p(u);E&&E.l(e),h=I(e),f=a(e,"DIV",{class:!0});var s=p(f);for(let n=0;n<j.length;n+=1)j[n].l(s);v=I(s),z&&z.l(s),s.forEach(c),e.forEach(c),this.h()},h(){l(f,"class","cards svelte-1xp7x0e"),l(u,"class","serie svelte-1xp7x0e")},m(e,s){o(e,d,s),o(e,u,s),E&&E.m(u,null),x(u,h),x(u,f);for(let t=0;t<j.length;t+=1)j[t].m(f,null);x(f,v),z&&z.m(f,null),t[5](f),C=!0},p(t,[e]){var s,n,a;if((!C||4&e)&&i!==(i="Pokemon Cards - "+(null==(s=t[2])?void 0:s.series))&&(V.title=i),(null==(a=null==(n=t[2])?void 0:n.images)?void 0:a.logo)?E?E.p(t,e):(E=q(t),E.c(),E.m(u,h)):E&&(E.d(1),E=null),8&e){let s;for(P=t[3],s=0;s<P.length;s+=1){const n=b(t,P,s);j[s]?(j[s].p(n,e),g(j[s],1)):(j[s]=_(n),j[s].c(),g(j[s],1),j[s].m(f,v))}for(L(),s=P.length;s<j.length;s+=1)S(s);w()}t[3].length<t[1]?z||(z=A(),z.c(),z.m(f,null)):z&&(z.d(1),z=null)},i(t){if(!C){for(let t=0;t<P.length;t+=1)g(j[t]);C=!0}},o(t){j=j.filter(Boolean);for(let e=0;e<j.length;e+=1)m(j[e]);C=!1},d(e){e&&c(d),e&&c(u),E&&E.d(),k(j,e),z&&z.d(),t[5](null)}}}var J=function(t,e,s,n){return new(s||(s=Promise))((function(a,l){function o(t){try{i(n.next(t))}catch(e){l(e)}}function r(t){try{i(n.throw(t))}catch(e){l(e)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,r)}i((n=n.apply(t,e||[])).next())}))};function K({page:t}){return J(this,void 0,void 0,(function*(){return{props:{setId:t.params.id}}}))}function O(t,e,s){let n,a;C(t,z,(t=>s(2,n=t))),C(t,H,(t=>s(3,a=t)));var l=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(a,l){function o(t){try{i(n.next(t))}catch(e){l(e)}}function r(t){try{i(n.throw(t))}catch(e){l(e)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,r)}i((n=n.apply(t,e||[])).next())}))};let o,r,{setId:i}=e;n||l(void 0,void 0,void 0,(function*(){return z.set((yield D(G.sets+"/"+i)).data)})),E((()=>{document.querySelector(".cards").onscroll=u})),P((()=>{a.length||(console.log("tgm : "+i.toUpperCase()),s(0,o.style.height="1000px",o),console.log(o),o.scrollTo(0,0),setTimeout((()=>{s(0,o.style.height="auto",o)}),1e3))}));let c={end:!1,next:1,isLoaded:!0};function d(t=1){return l(this,void 0,void 0,(function*(){D(G.cards+"?page="+t+"&pageSize=50&q=set.id:"+i).then((t=>{H.update((e=>e.concat(t.data))),s(1,r=t.totalCount),c={end:a.length>=r,next:t.page+1,isLoaded:!1}}))}))}function u(t){const e=t.target;e.scrollTop+window.innerHeight>=e.scrollHeight&&(c.end||c.isLoaded||(d(c.next),c.isLoaded=!0))}return t.$$set=t=>{"setId"in t&&s(4,i=t.setId)},t.$$.update=()=>{16&t.$$.dirty&&d()},[o,r,n,a,i,function(t){S[t?"unshift":"push"]((()=>{o=t,s(0,o)}))}]}export default class extends t{constructor(t){super(),e(this,t,O,B,s,{setId:4})}}export{K as load};
