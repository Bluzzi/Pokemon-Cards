import{S as t,i as e,s,e as n,c as a,b as l,f as r,I as o,J as c,d as i,P as d,j as u,m as h,o as f,x as g,u as m,v,a as p,E as x,k as $,O as I,n as w,w as y,H as k,K as E,A as C,Q as P,r as j}from"../../chunks/vendor-e99acf4a.js";import{c as L,j as S,E as b,a as D}from"../../chunks/Store-be29c69f.js";function G(t){let e,s,u,h,f;return{c(){e=n("img"),this.h()},l(t){e=a(t,"IMG",{src:!0,alt:!0,loading:!0,class:!0}),this.h()},h(){e.src!==(s=t[0].images.small)&&l(e,"src",s),l(e,"alt",u=t[0].name+" card"),l(e,"loading","lazy"),l(e,"class","svelte-14avgyx")},m(t,s){r(t,e,s),f=!0},p(t,[n]){(!f||1&n&&e.src!==(s=t[0].images.small))&&l(e,"src",s),(!f||1&n&&u!==(u=t[0].name+" card"))&&l(e,"alt",u)},i(t){f||(o((()=>{h||(h=c(e,d,{},!0)),h.run(1)})),f=!0)},o(t){h||(h=c(e,d,{},!1)),h.run(0),f=!1},d(t){t&&i(e),t&&h&&h.end()}}}function H(t,e,s){let{card:n}=e;return n.set.id.toUpperCase(),n.set.id.toUpperCase(),n.number,t.$$set=t=>{"card"in t&&s(0,n=t.card)},[n]}class M extends t{constructor(t){super(),e(this,t,H,G,s,{card:0})}}const{document:V}=P;function q(t,e,s){const n=t.slice();return n[8]=e[s],n}function z(t){let e,s;return{c(){e=n("img"),this.h()},l(t){e=a(t,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){e.src!==(s=t[1].images.logo)&&l(e,"src",s),l(e,"alt","serie logo"),l(e,"class","header svelte-1xp7x0e")},m(t,s){r(t,e,s)},p(t,n){2&n&&e.src!==(s=t[1].images.logo)&&l(e,"src",s)},d(t){t&&i(e)}}}function U(t){let e,s;return e=new M({props:{card:t[8]}}),{c(){u(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,n){f(e,t,n),s=!0},p(t,s){const n={};4&s&&(n.card=t[8]),e.$set(n)},i(t){s||(g(e.$$.fragment,t),s=!0)},o(t){m(e.$$.fragment,t),s=!1},d(t){v(e,t)}}}function _(t){let e,s,o;return{c(){e=n("div"),s=n("img"),this.h()},l(t){e=a(t,"DIV",{class:!0});var n=p(e);s=a(n,"IMG",{src:!0,alt:!0}),n.forEach(i),this.h()},h(){s.src!==(o="/img/loading.svg")&&l(s,"src","/img/loading.svg"),l(s,"alt","loading"),l(e,"class","load svelte-1xp7x0e")},m(t,n){r(t,e,n),x(e,s)},d(t){t&&i(e)}}}function A(t){var e,s,o;let c,d,u,h,f,v,E;V.title=c="Pokemon Cards - "+(null==(e=t[1])?void 0:e.series);let C=(null==(o=null==(s=t[1])?void 0:s.images)?void 0:o.logo)&&z(t),P=t[2],L=[];for(let n=0;n<P.length;n+=1)L[n]=U(q(t,P,n));const S=t=>m(L[t],1,1,(()=>{L[t]=null}));let b=t[2].length<t[0]&&_();return{c(){d=$(),u=n("div"),C&&C.c(),h=$(),f=n("div");for(let t=0;t<L.length;t+=1)L[t].c();v=$(),b&&b.c(),this.h()},l(t){I('[data-svelte="svelte-4gk4uf"]',V.head).forEach(i),d=w(t),u=a(t,"DIV",{class:!0});var e=p(u);C&&C.l(e),h=w(e),f=a(e,"DIV",{class:!0});var s=p(f);for(let n=0;n<L.length;n+=1)L[n].l(s);v=w(s),b&&b.l(s),s.forEach(i),e.forEach(i),this.h()},h(){l(f,"class","cards svelte-1xp7x0e"),l(u,"class","serie svelte-1xp7x0e")},m(t,e){r(t,d,e),r(t,u,e),C&&C.m(u,null),x(u,h),x(u,f);for(let s=0;s<L.length;s+=1)L[s].m(f,null);x(f,v),b&&b.m(f,null),E=!0},p(t,[e]){var s,n,a;if((!E||2&e)&&c!==(c="Pokemon Cards - "+(null==(s=t[1])?void 0:s.series))&&(V.title=c),(null==(a=null==(n=t[1])?void 0:n.images)?void 0:a.logo)?C?C.p(t,e):(C=z(t),C.c(),C.m(u,h)):C&&(C.d(1),C=null),4&e){let s;for(P=t[2],s=0;s<P.length;s+=1){const n=q(t,P,s);L[s]?(L[s].p(n,e),g(L[s],1)):(L[s]=U(n),L[s].c(),g(L[s],1),L[s].m(f,v))}for(j(),s=P.length;s<L.length;s+=1)S(s);y()}t[2].length<t[0]?b||(b=_(),b.c(),b.m(f,null)):b&&(b.d(1),b=null)},i(t){if(!E){for(let t=0;t<P.length;t+=1)g(L[t]);E=!0}},o(t){L=L.filter(Boolean);for(let e=0;e<L.length;e+=1)m(L[e]);E=!1},d(t){t&&i(d),t&&i(u),C&&C.d(),k(L,t),b&&b.d()}}}var B=function(t,e,s,n){return new(s||(s=Promise))((function(a,l){function r(t){try{c(n.next(t))}catch(e){l(e)}}function o(t){try{c(n.throw(t))}catch(e){l(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}c((n=n.apply(t,e||[])).next())}))};function J({page:t}){return B(this,void 0,void 0,(function*(){return{props:{setId:t.params.id}}}))}function K(t,e,s){let n,a;E(t,L,(t=>s(1,n=t))),E(t,D,(t=>s(2,a=t)));var l=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(a,l){function r(t){try{c(n.next(t))}catch(e){l(e)}}function o(t){try{c(n.throw(t))}catch(e){l(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}c((n=n.apply(t,e||[])).next())}))};let r,{setId:o}=e;n||l(void 0,void 0,void 0,(function*(){return L.set((yield S(b.sets+"/"+o)).data)})),C((()=>{document.querySelector(".cards").onscroll=d}));let c={end:!1,next:1,isLoaded:!0};function i(t=1){return l(this,void 0,void 0,(function*(){S(b.cards+"?page="+t+"&pageSize=50&q=set.id:"+o).then((t=>{D.update((e=>e.concat(t.data))),s(0,r=t.totalCount),c={end:a.length>=r,next:t.page+1,isLoaded:!1}}))}))}function d(t){const e=t.target;e.scrollTop+window.innerHeight>=e.scrollHeight&&(c.end||c.isLoaded||(i(c.next),c.isLoaded=!0))}return t.$$set=t=>{"setId"in t&&s(3,o=t.setId)},t.$$.update=()=>{8&t.$$.dirty&&i()},[r,n,a,o]}export default class extends t{constructor(t){super(),e(this,t,K,A,s,{setId:3})}}export{J as load};
